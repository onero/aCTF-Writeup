<!doctype html><html lang=en><head><meta charset=UTF-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="index, follow"><meta name=revisit-after content="15 days"><link rel=author href=/humans.txt><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileImage content="/mstile-144x144.png"><link rel="shortcut icon" href=/favicon.ico><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Rudolfs Simple Algoritme","name":"Rudolfs Simple Algoritme","description":"Challenge Name: Rudolfs Simple Algoritme\nCategory: Kom godt i gang\n","keywords":[],"articleBody":"Challenge Name: Rudolfs Simple Algoritme\nCategory: Kom godt i gang\nChallenge Description: Rudolf har krypteret flaget med RSA, men han har glemt, hvilke værdier han må dele, og hvilke der er hemmelige.\nKan du dekryptere hans flag?\nn = 18925541077824988712183209199079650116566712142533263598140310312267869339909616217074219588372785445276555780123046115230350459565816223330383386247738973670953655501222133239338895736270254698555339805998318917910649931316023627438828262249797009825103440676597924656257968596106423540073674857036082985165252462511218699089244945467187571072623490579151099801396985689250933808835629428463352657696286415936289158629585299425218570781030764634615060453765139004555499560932741462331656722996410976468325012470545433354833815198728434027509389192307483003046507871036717299333210733499795748579118306095556829263639 q = 118063811052597078076648057208258290925722946222241910613035885203409338850020920906592375946233241094333077964833028928470213309573854399800445879752747335760515740197890395360028081095608749779850729355973826460560998420377412739941103494034901004876773916365447039754161974845578315476777413979436560683093 e = 65537 ct = 15436002982413531167792439197855366628511742032858020132381247448034583641589139053141197248441750465498638214768245135475992457602527123482967943141258327043927292925664644100351630294623058653796001739830096433745160075993427695839812899234549970407943516319088414287369653326567748224801324184732924590389759109676037235181214031030181051149964539917324617030312886744245699648952675273750261984402368712095508858334065429006024222968042848231102366353871199812809955626892045929470339878801763957059048596399598780789796091488847291534189965452758394821078560041332079868199891048764803339019365629760271406619695 Se f.eks. her for mere info om, hvordan RSA fungerer\nApproach In this task, we are given a set of RSA parameters and an encrypted flag:\nIn RSA, two large prime numbers p and q are chosen, and from them, n = p * q is calculated, which is used as the modulus. An exponent e is chosen, and the public key for encryption then consists of e and n.\nThe private key d is calculated as the inverse of e modulo phi(n), that is, d = e^-1 mod phi(n). For the calculation, phi(n) is simply phi(n) = (p - 1) * (q - 1), when n is a product of two different prime numbers.\nThe security of RSA lies in the fact that only the recipient knows the two prime numbers p and q because with them phi(n) and thus d can be quickly found. Therefore, an important aspect of security is that it is difficult (practically impossible for large enough prime numbers) to factorize n and find p and q from it.\nHowever, Rudolf has been a bit confused and given us one of the prime numbers, q. With it, we can trivially find p and from there the private key, which can be used to decrypt the flag:\nThe following Python script can be used to solve the challenge\nfrom sympy import mod_inverse ## Implementation based on following documentation (in Danish) https://www.au.dk/fileadmin/www.au.dk/subuniversity/datalogi.pdf # Given values n = 18925541077824988712183209199079650116566712142533263598140310312267869339909616217074219588372785445276555780123046115230350459565816223330383386247738973670953655501222133239338895736270254698555339805998318917910649931316023627438828262249797009825103440676597924656257968596106423540073674857036082985165252462511218699089244945467187571072623490579151099801396985689250933808835629428463352657696286415936289158629585299425218570781030764634615060453765139004555499560932741462331656722996410976468325012470545433354833815198728434027509389192307483003046507871036717299333210733499795748579118306095556829263639 q = 118063811052597078076648057208258290925722946222241910613035885203409338850020920906592375946233241094333077964833028928470213309573854399800445879752747335760515740197890395360028081095608749779850729355973826460560998420377412739941103494034901004876773916365447039754161974845578315476777413979436560683093 e = 65537 ct = 15436002982413531167792439197855366628511742032858020132381247448034583641589139053141197248441750465498638214768245135475992457602527123482967943141258327043927292925664644100351630294623058653796001739830096433745160075993427695839812899234549970407943516319088414287369653326567748224801324184732924590389759109676037235181214031030181051149964539917324617030312886744245699648952675273750261984402368712095508858334065429006024222968042848231102366353871199812809955626892045929470339878801763957059048596399598780789796091488847291534189965452758394821078560041332079868199891048764803339019365629760271406619695 # Calculate the totient of n phi_n = (q - 1) * ((n // q) - 1) # Calculate the private exponent d d = mod_inverse(e, phi_n) # Decrypt the ciphertext plaintext = pow(ct, d, n) # Convert the decrypted plaintext to a string decrypted_message = bytearray.fromhex(hex(plaintext)[2:]).decode() print(\"Decrypted Message:\", decrypted_message) Flag NC3{s1mp3l_RS4_3r_1ng3n_s4g} Reflections and Learnings Working on Rudolf’s Simple Algorithm challenge presented an excellent opportunity to dive deep into the fundamentals of RSA encryption, especially the importance of keeping certain elements confidential! The challenge highlighted how revealing even a single prime number used in RSA can completely compromise the security of the encrypted data.\nOne key takeaway from this challenge was the practical implications of RSA’s theoretical security model. RSA’s robustness hinges on the difficulty of factoring large numbers into their prime components. However, this challenge served as a reminder that even the most secure systems can be vulnerable if not all components are treated with the same level of confidentiality. In this case, Rudolf’s mistake of revealing one of the prime numbers, q, turned the theoretically unbreakable RSA encryption into a simple puzzle.\nSolving this challenge reinforced the understanding of the RSA algorithm, particularly how the private key is derived and used for decryption. It was fascinating to see how quickly and efficiently the flag could be decrypted once p was calculated using the given q and n. This process of calculating the private exponent d from e and phi(n) was a practical demonstration of the mathematical principles underlying RSA!\n","wordCount":"550","inLanguage":"en","datePublished":"2023-12-01T10:10:50+01:00","dateModified":"2023-12-01T10:10:50+01:00","author":{"@type":"Person","name":"Adamino"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ctf.adamino.dk/nc3/kom-godt-i-gang/rudolfs-simple-algoritme/"},"publisher":{"@type":"Organization","name":"Adamino CTF Writeups","description":"","logo":{"@type":"ImageObject","url":"https://ctf.adamino.dk/favicon.ico"}}}</script><title>Rudolfs Simple Algoritme</title><link rel="stylesheet dns-prefetch preconnect preload prefetch" as=style media=screen href=https://ctf.adamino.dk/css/style.min.cc693dc2db3884100ca44fa2a72237cac58c5c838c68de96c428b14163b2e2b9.css integrity="sha256-zGk9wts4hBAMpE+ipyI3ysWMXIOMaN6WxCixQWOy4rk=" crossorigin=anonymous></head><body id=page><header id=site-header><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://ctf.adamino.dk/>Adamino CTF Writeups</a></div><nav class="site-nav hide-in-mobile"><a href=https://ctf.adamino.dk/tools/>Tools</a><a href=https://ctf.adamino.dk/nc3/>NC3</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-links hide-in-mobile"><a href=https://github.com/onero target=_blank rel="noopener me" title=Github><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://ctf.adamino.dk/tools/>Tools</a></li><li><a href=https://ctf.adamino.dk/nc3/>NC3</a></li></ul></div><main class="site-main section-inner thin animated fadeIn faster"><h1>Rudolfs Simple Algoritme</h1><div class=content><h2 id=challenge-name>Challenge Name:<a href=#challenge-name class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Rudolfs Simple Algoritme</p><h2 id=category>Category:<a href=#category class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Kom godt i gang</p><h2 id=challenge-description>Challenge Description:<a href=#challenge-description class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Rudolf har krypteret flaget med RSA, men han har glemt, hvilke værdier han må dele, og hvilke der er hemmelige.</p><p>Kan du dekryptere hans flag?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>18925541077824988712183209199079650116566712142533263598140310312267869339909616217074219588372785445276555780123046115230350459565816223330383386247738973670953655501222133239338895736270254698555339805998318917910649931316023627438828262249797009825103440676597924656257968596106423540073674857036082985165252462511218699089244945467187571072623490579151099801396985689250933808835629428463352657696286415936289158629585299425218570781030764634615060453765139004555499560932741462331656722996410976468325012470545433354833815198728434027509389192307483003046507871036717299333210733499795748579118306095556829263639</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>118063811052597078076648057208258290925722946222241910613035885203409338850020920906592375946233241094333077964833028928470213309573854399800445879752747335760515740197890395360028081095608749779850729355973826460560998420377412739941103494034901004876773916365447039754161974845578315476777413979436560683093</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>ct <span style=color:#f92672>=</span> <span style=color:#ae81ff>15436002982413531167792439197855366628511742032858020132381247448034583641589139053141197248441750465498638214768245135475992457602527123482967943141258327043927292925664644100351630294623058653796001739830096433745160075993427695839812899234549970407943516319088414287369653326567748224801324184732924590389759109676037235181214031030181051149964539917324617030312886744245699648952675273750261984402368712095508858334065429006024222968042848231102366353871199812809955626892045929470339878801763957059048596399598780789796091488847291534189965452758394821078560041332079868199891048764803339019365629760271406619695</span>
</span></span></code></pre></div><p><em>Se f.eks. <a href=https://www.au.dk/fileadmin/www.au.dk/subuniversity/datalogi.pdf>her</a> for mere info om, hvordan RSA fungerer</em></p><h2 id=approach>Approach<a href=#approach class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>In this task, we are given a set of RSA parameters and an encrypted flag:</p><p>In RSA, two large prime numbers p and q are chosen, and from them, n = p * q is calculated, which is used as the modulus. An exponent e is chosen, and the public key for encryption then consists of e and n.</p><p>The private key d is calculated as the inverse of e modulo phi(n), that is, d = e^-1 mod phi(n). For the calculation, phi(n) is simply phi(n) = (p - 1) * (q - 1), when n is a product of two different prime numbers.</p><p>The security of RSA lies in the fact that only the recipient knows the two prime numbers p and q because with them phi(n) and thus d can be quickly found. Therefore, an important aspect of security is that it is difficult (practically impossible for large enough prime numbers) to factorize n and find p and q from it.</p><p>However, Rudolf has been a bit confused and given us one of the prime numbers, q. With it, we can trivially find p and from there the private key, which can be used to decrypt the flag:</p><p>The following Python script can be used to solve the challenge</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> sympy <span style=color:#f92672>import</span> mod_inverse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Implementation based on following documentation (in Danish) https://www.au.dk/fileadmin/www.au.dk/subuniversity/datalogi.pdf</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Given values</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> <span style=color:#ae81ff>18925541077824988712183209199079650116566712142533263598140310312267869339909616217074219588372785445276555780123046115230350459565816223330383386247738973670953655501222133239338895736270254698555339805998318917910649931316023627438828262249797009825103440676597924656257968596106423540073674857036082985165252462511218699089244945467187571072623490579151099801396985689250933808835629428463352657696286415936289158629585299425218570781030764634615060453765139004555499560932741462331656722996410976468325012470545433354833815198728434027509389192307483003046507871036717299333210733499795748579118306095556829263639</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>=</span> <span style=color:#ae81ff>118063811052597078076648057208258290925722946222241910613035885203409338850020920906592375946233241094333077964833028928470213309573854399800445879752747335760515740197890395360028081095608749779850729355973826460560998420377412739941103494034901004876773916365447039754161974845578315476777413979436560683093</span>
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>ct <span style=color:#f92672>=</span> <span style=color:#ae81ff>15436002982413531167792439197855366628511742032858020132381247448034583641589139053141197248441750465498638214768245135475992457602527123482967943141258327043927292925664644100351630294623058653796001739830096433745160075993427695839812899234549970407943516319088414287369653326567748224801324184732924590389759109676037235181214031030181051149964539917324617030312886744245699648952675273750261984402368712095508858334065429006024222968042848231102366353871199812809955626892045929470339878801763957059048596399598780789796091488847291534189965452758394821078560041332079868199891048764803339019365629760271406619695</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the totient of n</span>
</span></span><span style=display:flex><span>phi_n <span style=color:#f92672>=</span> (q <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> ((n <span style=color:#f92672>//</span> q) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the private exponent d</span>
</span></span><span style=display:flex><span>d <span style=color:#f92672>=</span> mod_inverse(e, phi_n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Decrypt the ciphertext</span>
</span></span><span style=display:flex><span>plaintext <span style=color:#f92672>=</span> pow(ct, d, n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert the decrypted plaintext to a string</span>
</span></span><span style=display:flex><span>decrypted_message <span style=color:#f92672>=</span> bytearray<span style=color:#f92672>.</span>fromhex(hex(plaintext)[<span style=color:#ae81ff>2</span>:])<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Decrypted Message:&#34;</span>, decrypted_message)
</span></span></code></pre></div><h2 id=flag>Flag<a href=#flag class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>NC3{s1mp3l_RS4_3r_1ng3n_s4g}
</span></span></code></pre></div><h2 id=reflections-and-learnings>Reflections and Learnings<a href=#reflections-and-learnings class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Working on Rudolf&rsquo;s Simple Algorithm challenge presented an excellent opportunity to dive deep into the fundamentals of RSA encryption, especially the importance of keeping certain elements confidential! The challenge highlighted how revealing even a single prime number used in RSA can completely compromise the security of the encrypted data.</p><p>One key takeaway from this challenge was the practical implications of RSA&rsquo;s theoretical security model. RSA&rsquo;s robustness hinges on the difficulty of factoring large numbers into their prime components. However, this challenge served as a reminder that even the most secure systems can be vulnerable if not all components are treated with the same level of confidentiality. In this case, Rudolf&rsquo;s mistake of revealing one of the prime numbers, q, turned the theoretically unbreakable RSA encryption into a simple puzzle.</p><p>Solving this challenge reinforced the understanding of the RSA algorithm, particularly how the private key is derived and used for decryption. It was fascinating to see how quickly and efficiently the flag could be decrypted once p was calculated using the given q and n. This process of calculating the private exponent d from e and phi(n) was a practical demonstration of the mathematical principles underlying RSA!</p></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2025 <a href=https://ctf.adamino.dk/>Adamino</a>
&#183; The quieter you become the more you are able to hear
&#183;</p></footer><a href=# class=scroll-up><svg fill="#3b3e48" width="64" height="64" viewBox="-2.4 -2.4 28.8 28.8" id="up-circle" data-name="Flat Color" class="icon flat-color" stroke="#3b3e48" stroke-width=".00024000000000000003"><g id="SVGRepo_bgCarrier" stroke-width="0"/><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#ccc" stroke-width=".9600000000000002"><circle id="primary" cx="12" cy="12" r="10" style="fill:#3b3e48"/><path id="secondary" d="M15 14a1 1 0 01-.71-.29L12 11.41l-2.29 2.3a1 1 0 01-1.42-1.42l3-3a1 1 0 011.42.0l3 3a1 1 0 010 1.42A1 1 0 0115 14z" style="fill:#0077b6"/></g><g id="SVGRepo_iconCarrier"><circle id="primary" cx="12" cy="12" r="10" style="fill:#3b3e48"/><path id="secondary" d="M15 14a1 1 0 01-.71-.29L12 11.41l-2.29 2.3a1 1 0 01-1.42-1.42l3-3a1 1 0 011.42.0l3 3a1 1 0 010 1.42A1 1 0 0115 14z" style="fill:#0077b6"/></g></svg></a><noscript><a href=# class="scroll-up show"><svg fill="#3b3e48" width="64" height="64" viewBox="-2.4 -2.4 28.8 28.8" id="up-circle" data-name="Flat Color" class="icon flat-color" stroke="#3b3e48" stroke-width=".00024000000000000003"><g id="SVGRepo_bgCarrier" stroke-width="0"/><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#ccc" stroke-width=".9600000000000002"><circle id="primary" cx="12" cy="12" r="10" style="fill:#3b3e48"/><path id="secondary" d="M15 14a1 1 0 01-.71-.29L12 11.41l-2.29 2.3a1 1 0 01-1.42-1.42l3-3a1 1 0 011.42.0l3 3a1 1 0 010 1.42A1 1 0 0115 14z" style="fill:#0077b6"/></g><g id="SVGRepo_iconCarrier"><circle id="primary" cx="12" cy="12" r="10" style="fill:#3b3e48"/><path id="secondary" d="M15 14a1 1 0 01-.71-.29L12 11.41l-2.29 2.3a1 1 0 01-1.42-1.42l3-3a1 1 0 011.42.0l3 3a1 1 0 010 1.42A1 1 0 0115 14z" style="fill:#0077b6"/></g></svg></a></noscript><script async src=https://ctf.adamino.dk/js/scrollwatcher.min.d1ed6600a7470c80aa1291ec4def14df9eaf4eda42bf9e178bf9944c457b5bcc.js integrity="sha256-0e1mAKdHDICqEpHsTe8U356vTtpCv54Xi/mUTEV7W8w=" crossorigin=anonymous></script><script async src=https://ctf.adamino.dk/js/bundle.min.217d62397cbef6f9f5d8bab30d7e7969d78c52a436ca5d5790cef4d6fef3f1f2.js integrity="sha256-IX1iOXy+9vn12LqzDX55adeMUqQ2yl1XkM701v7z8fI=" crossorigin=anonymous></script></body></html>