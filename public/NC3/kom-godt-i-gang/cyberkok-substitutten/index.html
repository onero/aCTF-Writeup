<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>


<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="robots" content="index, follow">
<meta name="revisit-after" content="15 days">
<link rel="author" href="/humans.txt">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<link rel="shortcut icon" href="/favicon.ico">




  <meta itemprop="name" content="Cyberkok Substitutten">
  <meta itemprop="description" content="Challenge Name: Cyberkok Substitutten
Category: kom-godt-i-gang">
  <meta itemprop="datePublished" content="2023-12-01T10:04:58+01:00">
  <meta itemprop="dateModified" content="2023-12-01T10:04:58+01:00">
  <meta itemprop="wordCount" content="427">
  <meta itemprop="keywords" content="Kom Godt I Gang"><title>Cyberkok Substitutten</title><link rel="stylesheet dns-prefetch preconnect preload prefetch" as="style" media="screen" href="http://localhost:1313/css/style.min.cc693dc2db3884100ca44fa2a72237cac58c5c838c68de96c428b14163b2e2b9.css" integrity="sha256-zGk9wts4hBAMpE+ipyI3ysWMXIOMaN6WxCixQWOy4rk=" crossorigin="anonymous">
	</head>

<body id="page">


<header id="site-header">
	<div class="hdr-wrapper section-inner">
		<div class="hdr-left">
			<div class="site-branding">
				<a href="http://localhost:1313/">Adamino CTF Writeups</a>
			</div>
			<nav class="site-nav hide-in-mobile"><a href="http://localhost:1313/tools/">Tools</a><a href="http://localhost:1313/nc3/">NC3</a></nav>
		</div>
		<div class="hdr-right hdr-icons">
			<span class="hdr-links hide-in-mobile"><a href="https://github.com/onero" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24"
  fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path
    d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
  </path>
</svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
  class="feather feather-menu">
  <line x1="3" y1="12" x2="21" y2="12"></line>
  <line x1="3" y1="6" x2="21" y2="6"></line>
  <line x1="3" y1="18" x2="21" y2="18"></line>
</svg></button>
		</div>
	</div>
</header>
<div id="mobile-menu" class="animated fast">
	<ul>
		<li><a href="http://localhost:1313/tools/">Tools</a></li>
		<li><a href="http://localhost:1313/nc3/">NC3</a></li>
	</ul>
</div>

	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>Cyberkok Substitutten</h1>
		<div class="content">
			<h2 id="challenge-name">Challenge Name:<a href="#challenge-name" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
  <line x1="8" y1="12" x2="16" y2="12"></line>
</svg></a></h2>
<p>Cyberkok Substitutten</p>
<h2 id="category">Category:<a href="#category" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
  <line x1="8" y1="12" x2="16" y2="12"></line>
</svg></a></h2>
<p>kom-godt-i-gang</p>
<h2 id="challenge-description">Challenge Description:<a href="#challenge-description" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
  <line x1="8" y1="12" x2="16" y2="12"></line>
</svg></a></h2>
<p>&hellip; Err&hellip; Cyberkokken har vist haft en substitutvikar på besøg, som har sendt os følgende besked. Kan du hjælpe?</p>
<p>[Translated]
We seem to have received a message from a substitute chef, who has sent us the following message. Can you help?</p>
<p><em>Hint: The text is in English</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>qHbJXb QR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>T1 7eb eb5J7 2G 7eb rmJ7u5W lm7geb1, (ebJb g28bX 518 g22lmbX g2WWm8b,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>UebJb&#39;X 5 gBjbJ gebG 15Ib8 Mm1aWbX, X4Jb58m1a f2B G5J 518 (m8b.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Om7e gmJgum7X euIIm1a 518 4m0bWX aWb5Im1a, eb 821X emX gebG&#39;X e57,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>k GbX7mrb 54J21 (J544b8 5J2u18, Jb58B G2J 7emX X(bb7 ge57.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>q}e2JuXR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mm1aWb, fm1aWb, gBjbJ gebG, j5lm1a g22lmbX (m7e 8bWmae7,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>T1 7eb 8mam75W 2rb1, g22lmbX j5lb 5WW 7eJ2uae 7eb 1mae7.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>KB7bX 2G f2B 518 Xua5JB g28b, 5 Jbgm4b X2 8mrm1b,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>M2WWB }eJmX7I5X I2Ib17X, m1 brbJB jB7b 518 Wm1b.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>continues on with similar text.....
</span></span></code></pre></div><h2 id="approach">Approach<a href="#approach" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
  <line x1="8" y1="12" x2="16" y2="12"></line>
</svg></a></h2>
<p>As indicated, the text is in English. We first observe that the text is structured with line breaks and typically ends with commas or periods. The first line in each section is noticeably shorter than the rest, and almost all lines end with the same two letters in an AA BB structure, typical of many rhymes.</p>
<p>Structured data like this is commonly seen in Caesar ciphers. Yet running it though a Caesar cipher decoder doesn&rsquo;t yield anything meaningful, suggesting a more complex cipher.</p>
<p>To gain insights, we try to employ a frequency analysis. A quick search reveals the most common letters in the English Dictionary. Given the cipher text&rsquo;s length, this should provide useful insights.</p>
<p><img src="/nc3/kom-godt-i-gang/cyberkok-substitutten/english-letter-frequency.png" alt="english-letter-frequency.png"></p>
<p>Using a Python script, we analyze the letter frequency of the ciphered text:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_message_from_file</span>(file_path):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(file_path, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> file<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>file_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;besked.txt&#39;</span>
</span></span><span style="display:flex;"><span>message <span style="color:#f92672">=</span> read_message_from_file(file_path)
</span></span><span style="display:flex;"><span>message_no_spaces_newlines <span style="color:#f92672">=</span> message<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>char_frequency <span style="color:#f92672">=</span> Counter(message_no_spaces_newlines)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>total_chars <span style="color:#f92672">=</span> sum(char_frequency<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sorted_char_frequency <span style="color:#f92672">=</span> dict(sorted(char_frequency<span style="color:#f92672">.</span>items(), key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> item: item[<span style="color:#ae81ff">1</span>], reverse<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> char, count <span style="color:#f92672">in</span> sorted_char_frequency<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>    percentage <span style="color:#f92672">=</span> (count <span style="color:#f92672">/</span> total_chars) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#39;</span><span style="color:#e6db74">{</span>char<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;: </span><span style="color:#e6db74">{</span>count<span style="color:#e6db74">}</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">{</span>percentage<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">%)&#34;</span>)
</span></span></code></pre></div><p><img src="/nc3/kom-godt-i-gang/cyberkok-substitutten/substitutten-letter-frequency.png" alt="substitutten-letter-frequency.png"></p>
<p>Starting with shorter words helps in deciphering the text. For example, deciphering &ldquo;7eb&rdquo; as &ldquo;the&rdquo; is an initial step. To simplify this process, we use a helper program for character substitution:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">replace_characters</span>(message):
</span></span><span style="display:flex;"><span>    char_map <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;b&#39;</span>: <span style="color:#e6db74">&#39;e&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;7&#39;</span>: <span style="color:#e6db74">&#39;t&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;e&#39;</span>: <span style="color:#e6db74">&#39;h&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ANSI escape code for red color and reset</span>
</span></span><span style="display:flex;"><span>    RED <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[91m&#39;</span>
</span></span><span style="display:flex;"><span>    RESET <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[0m&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    modified_message <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> message:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> char <span style="color:#f92672">in</span> char_map:
</span></span><span style="display:flex;"><span>            modified_message<span style="color:#f92672">.</span>append(char_map[char])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            modified_message<span style="color:#f92672">.</span>append(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>RED<span style="color:#e6db74">}{</span>char<span style="color:#e6db74">}{</span>RESET<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(modified_message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>file_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;besked.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>message <span style="color:#f92672">=</span> read_message_from_file(file_path)
</span></span><span style="display:flex;"><span>modified_message <span style="color:#f92672">=</span> replace_characters(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(modified_message)
</span></span></code></pre></div><p><img src="/nc3/kom-godt-i-gang/cyberkok-substitutten/letter-replacer-script.png" alt="letter-replacer-script.png"></p>
<p>The output of this script aids in gradually mapping out more characters:</p>
<p><img src="/nc3/kom-godt-i-gang/cyberkok-substitutten/letter-replacer-script2.png" alt="letter-replacer-script2.png"></p>
<p>Lastly getting the flag:
<img src="/nc3/kom-godt-i-gang/cyberkok-substitutten/letter-replacer-script3.png" alt="letter-replacer-script3.png"></p>
<h2 id="flag">Flag<a href="#flag" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
  <line x1="8" y1="12" x2="16" y2="12"></line>
</svg></a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>nc3{merry-merry-cookie-christmas}
</span></span></code></pre></div>
		</div>
		
	</main>
<footer id="site-footer" class="section-inner thin animated fadeIn faster"><p>
  &copy; 2025 <a href="http://localhost:1313/">Adamino</a>
  &#183; The quieter you become the more you are able to hear
  
  &#183;
  
</p></footer>

<a href="#" class="scroll-up"><svg xmlns="http://www.w3.org/2000/svg" fill="#3B3E48" width="64px" height="64px"
  viewBox="-2.4 -2.4 28.80 28.80" id="up-circle" data-name="Flat Color"
  xmlns="http://www.w3.org/2000/svg" class="icon flat-color" stroke="#3B3E48"
  stroke-width="0.00024000000000000003">
  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
  <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC"
    stroke-width="0.9600000000000002">
    <circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle>
    <path id="secondary"
      d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z"
      style="fill: #0077b6;"></path>
  </g>
  <g id="SVGRepo_iconCarrier">
    <circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle>
    <path id="secondary"
      d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z"
      style="fill: #0077b6;"></path>
  </g>
</svg></a>
<noscript>
    <a href="#" class="scroll-up show"><svg xmlns="http://www.w3.org/2000/svg" fill="#3B3E48" width="64px" height="64px"
  viewBox="-2.4 -2.4 28.80 28.80" id="up-circle" data-name="Flat Color"
  xmlns="http://www.w3.org/2000/svg" class="icon flat-color" stroke="#3B3E48"
  stroke-width="0.00024000000000000003">
  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
  <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC"
    stroke-width="0.9600000000000002">
    <circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle>
    <path id="secondary"
      d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z"
      style="fill: #0077b6;"></path>
  </g>
  <g id="SVGRepo_iconCarrier">
    <circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle>
    <path id="secondary"
      d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z"
      style="fill: #0077b6;"></path>
  </g>
</svg></a>
</noscript>
<script async src="http://localhost:1313/js/scrollwatcher.min.d1ed6600a7470c80aa1291ec4def14df9eaf4eda42bf9e178bf9944c457b5bcc.js" integrity="sha256-0e1mAKdHDICqEpHsTe8U356vTtpCv54Xi/mUTEV7W8w=" crossorigin="anonymous"></script>
<script async src="http://localhost:1313/js/bundle.min.217d62397cbef6f9f5d8bab30d7e7969d78c52a436ca5d5790cef4d6fef3f1f2.js" integrity="sha256-IX1iOXy+9vn12LqzDX55adeMUqQ2yl1XkM701v7z8fI=" crossorigin="anonymous"></script>

</body>
</html>